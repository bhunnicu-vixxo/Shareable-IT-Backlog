# ================================================================
# Shareable Linear Backlog — Environment Variables
# ================================================================
# Copy this file to .env and fill in values for your environment.
# For production deployments, see .env.production.example instead.
#
# IMPORTANT: Never commit actual .env files — they contain secrets.
# ================================================================

# ===== FRONTEND (frontend/.env) =====
# Use same origin in dev so Vite can proxy /api to the backend (avoids CORS).
# Dev: http://localhost:1576/api (Vite proxies to backend; configure with VITE_PROXY_TARGET if needed)
VITE_API_URL=http://localhost:1576/api

# ===== BACKEND (backend/.env) =====
# Server port for the Express backend
PORT=3000
# Environment: development | production
NODE_ENV=development
# Log level: trace | debug | info | warn | error | fatal
LOG_LEVEL=info
# CORS — comma-separated list of allowed origins
ALLOWED_ORIGINS=http://localhost:1576

# Linear API key for syncing backlog data
LINEAR_API_KEY=lin_api_YOUR_KEY_HERE

# Sync Configuration
# Set to false to disable scheduled sync entirely (default: true)
SYNC_ENABLED=true
# Cron expression for sync schedule (default: twice daily at 6 AM and 12 PM)
SYNC_CRON_SCHEDULE=0 6,12 * * *
# Optional: protect manual sync trigger endpoint (when set, `POST /api/sync/trigger`
# requires `Authorization: Bearer <token>` or `X-Sync-Trigger-Token: <token>`).
# Supports encrypted values with enc: prefix (see CREDENTIAL_ENCRYPTION_KEY).
# See docs/credential-management.md for rotation procedures.
# SYNC_TRIGGER_TOKEN=your-admin-trigger-token-here

# Network Access Control (Epic 7)
# Comma-separated CIDR ranges for allowed networks (e.g., 10.0.0.0/8,172.16.0.0/12,192.168.0.0/16)
# When NETWORK_CHECK_ENABLED=true, only IPs within these ranges can access the API (except /api/health).
ALLOWED_NETWORKS=10.0.0.0/8,172.16.0.0/12,192.168.0.0/16
# Set to false to disable network verification (development). Default: true in production.
NETWORK_CHECK_ENABLED=false

# Session Configuration (Epic 7 — User Approval Workflow)
# Secret key for signing session cookies. MUST be changed in production (32+ chars).
# Supports encrypted values with enc: prefix (see CREDENTIAL_ENCRYPTION_KEY).
SESSION_SECRET=change-me-in-production

# Database — PostgreSQL connection string
# For Azure PostgreSQL, append: ?sslmode=require&uselibpqcompat=true
# Supports encrypted values with enc: prefix (see CREDENTIAL_ENCRYPTION_KEY).
# See docs/credential-management.md for rotation procedures.
DATABASE_URL=postgresql://user:password@localhost:5432/shareable_linear_backlog

# Security — Credential Encryption (Epic 10 — Story 10.1, 10.4)
# Optional: passphrase used to encrypt/decrypt env var values prefixed with "enc:".
# When set, LINEAR_API_KEY, SESSION_SECRET, DATABASE_URL, and SYNC_TRIGGER_TOKEN
# can be stored encrypted. Required if any env var uses the enc: prefix.
# Not required for development (plaintext values pass through unchanged).
# See docs/credential-management.md for full encryption guide and rotation procedures.
# CREDENTIAL_ENCRYPTION_KEY=your-strong-passphrase-here

# Security — Database Column Encryption (Epic 10 — Story 10.1)
# Key used by pgcrypto pgp_sym_encrypt/decrypt for column-level encryption.
# DB_ENCRYPTION_KEY=your-db-encryption-key-here

# Security — Database SSL (Epic 10 — Story 10.1)
# Set to true to enable SSL for PostgreSQL connections. Auto-enabled in production.
# DB_SSL_ENABLED=false

# ===== DOCKER COMPOSE =====
# Used by docker-compose.yml and docker-compose.prod.yml
DB_USER=slb_user
# IMPORTANT: DB_PASSWORD must NOT contain URI-reserved characters (@, :, /, ?, #, %, etc.)
# because it is interpolated directly into DATABASE_URL. Use alphanumeric + simple symbols
# (e.g., -, _, .) or URL-encode special characters manually.
DB_PASSWORD=slb_dev_password
DB_NAME=shareable_linear_backlog
DB_PORT=5432

# ===== HEALTH CHECK & MONITORING (Epic 12 — Story 12.2) =====
# Interval between automated health checks (ms). Default: 60000 (1 minute)
# HEALTH_CHECK_INTERVAL_MS=60000
# Timeout for Linear API health check (ms). Default: 5000 (5 seconds)
# HEALTH_CHECK_LINEAR_TIMEOUT_MS=5000
# Webhook URL for health status alerts (optional, leave unset to disable alerts)
# ALERT_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
# Cooldown between alerts (ms). Default: 300000 (5 minutes)
# ALERT_COOLDOWN_MS=300000
